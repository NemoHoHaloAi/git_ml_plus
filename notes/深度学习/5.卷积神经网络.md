# 卷积神经网络

## 简介
当你的数据具备某种结构，但是网络不需要从头学习这个结构，那么这个网络会表现的更好；

举个例子：
1. 对于字母识别，我们有5张不同颜色的A的图片，那么构建模型输入的数据是使用RGB好呢，还是使用灰度好？
        
    1. 这个答案是显而易见的，灰度数据忽略了原始数据中的颜色，而颜色这一部分在数据结构上对于我们的分类是没有帮助的，反而可能会迷惑我们的模型；
2. 对于图像识别，比如要识别图中是否有一只猫；

    1. 那么我们不会刻意去识别某个位置是否有一只猫，而是忽略这个位置属性，而是只要存在猫就行；

## 卷积神经网络-CovNet
卷积网络是一种空间上共享权重的网络，简单说就是使用卷积层替代全连接层，比如一张图片，具备宽度和高度，由于一般由RGB三通道组成，因此它还具备为3
的深度，想象拿出图片的一小部分运行一个输出为k的小神经网络，同时将这一小块像刷子一样刷过整个图像，那么对应的会生成一个宽和高都更小，但是深度
为k的另一个数据体，这种操作称之为卷积，理论上期望它形成金字塔形，通过不断的卷积来压缩空间的维度，使得宽度和高度持续降低，而深度逐渐增高，我们
直到深度代表的就是含义，RGB是最具体、最表面的含义，而我们期望的是更高抽象层次的含义，这就需要更深的数据来表示；

## 直观感受卷积网络的工作方式
它学习识别基本的直线，曲线，然后是形状，点块，然后是图片中更复杂的物体。最终 CNN 分类器把这些大的，复杂的物体综合起来识别图片。

在我们的识别狗狗的例子中，层级关系是：

* 简单的形状，如椭圆，暗色圆圈
* 复杂的物体（简单形状的组合），例如眼睛，鼻子，毛发
* 狗的整体（复杂物体的组合）

CNN 可能有几层网络，每个层可能捕获对象抽象层次中的不同级别。第一层是抽象层次的最底级，CNN 一般把图片中的较小的部分识别成简单的形状，例如水平、竖直的直线，简单的色块。
下一层将会上升到更高的抽象层次，一般会识别更复杂的概念，例如形状（线的组合），以此类推直至最终识别整个物体，例如狗。

## 工作
1. 第一步是将图片分为小块，通过选取一个给定宽高的滤波器来实现；
2. 滤波器对原始图片进行扫描，从而得到跟滤波器一样宽高的patch块；
3. 滤波器的滑动步长stride决定了选择的密度，这是一个可调的超参数；
4. 滤波器的个数称为滤波器的深度，通常有多个来提取同一个patch的不同特性，例如一个提取颜色，一个提取形状；
5. 每个patch连接的神经元个数取决于滤波器的个数k，这也是下一个卷积层的深度，一个patch连接多个神经元的意义在于一个patch可能有多个特征需要提取，因此需要多个神经元，当然也对应多个滤波器来处理它；
6. PS:CNN并没有被指定取寻找哪些特征，相反，它是通过正向、反向传播取自我学习这些特征，而且通常效果会很好；

## 感觉-PCA
感觉有点像PCA的过程，不知道为啥；

## 维度
计算 CNN 中每一层神经元的数量呢？

输入层（input layer）维度值为**W**， 滤波器（filter）的维度值为 **F** (height * width * depth)， 
stride 的数值为 **S**， padding 的数值为 **P**， 下一层的维度值可用如下公式表示: **(W−F+2P)/S+1**。
