# 贝叶斯推理

## 联合分布

## 信念网络：贝叶斯网络
以图的形式来表示联合分布中的条件独立性；

PS：注意信念网络中的箭头关系代表的是一种统计相关性，并不表示因果关系；

## 从联合分布中取样
按照拓扑顺序，也就是没有导入的节点在有导入的节点前，被导入的节点在导入的节点后；

## 关系
联合分布中，如果没有父节点，那么它的可能性只有一种（就是个常数），如果有父节点，那么他的可能性就是父节点的个数指数增长；

## 推理规则
1. 边缘化规则：X，Y非独立，P(X)=sum(P(X|Y))，Y取所有可能的值；
2. 莲式规则：P(X,Y)=P(X)\*P(Y|X)，表示X节点无导入，Y节点依赖于X节点；
3. 贝叶斯规则：P(Y|X)=(P(X|Y)P(Y))/P(X)；

## 手工推理
问题：两个箱子，一个里面有3个绿色球，1个黄球，一个里面有3个蓝色球，2个绿色球，
首先随机从某一个箱子中拿出一个球，然后不放回的情况下再从这个箱子中取出一个球，
问，第一次拿到绿色球，第二次拿到蓝色球的概率是多少？

推理过程：
1. 绘制贝叶斯网络：
    1. Node(箱子):选择箱子1还是箱子2，由于没有导入，因此认为是.5；
    2. Node(Pick1):第一次拿球：
                   
                    绿色    黄色    蓝色
            Box1    3/4     1/4     0
            Box2    2/5     0       3/5
    3. Node(Pick2):第二次拿球，已知上一次拿了一个绿色球：
                   
                    绿色    黄色    蓝色
            Box1    2/3     1/3     0
            Box2    1/4     0       3/4
2. Node(Pick2)依赖于上述两个节点，因为即使知道第一次拿的是绿色球，也无法判断是从哪个箱子里拿的，也就无从判断第二次拿到蓝色球的概率；
3. 在不考虑哪个箱子的情况下：Box1中蓝色概率为0，Box2中蓝色概率为3/4；
4. P(Box1|1=G)=15/23，P(Box2|1=G)=8/23，23是归一化得到的；
5. 现在要计算P(2=B|1=G,Box1)=P(2=B|1=G)P(Box1|1=G)=0\*(15/23)，同理P(2=B|1=G,Box2)=P(2=B|1=G)P(Box2|1=G)=(3/4)\*(8/23)；

## 朴素贝叶斯
之所以说是朴素或者说天真，是因为在推理过程中，我们对很多属性的关系都假设是条件独立的，而这在现实中几乎不可能成立；
